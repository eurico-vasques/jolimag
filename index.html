<!doctype html>
<html lang="pt">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Jolimag — Splash + Banner</title>
<style>
  :root{
    --rail-w: 75px;                 /* largura da barra esquerda */
    --gutter: 24px;
    --title-size: clamp(20px, 17vw, 10vw);
    --subtitle-size: 14px;
    --fade: 700ms;                  /* fade dos banners */
    /* Loader */
    --loader-size: 140px;
    --beat-speed: 1s;               /* velocidade de cada batimento */
    --beat-time: 3000ms;            /* tempo total a “bater” */
    --blast-time: 600ms;            /* duração da expansão final */
  }

  *{ box-sizing: border-box }
  html, body{ height:100%; margin:0 }
  body{ font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif; background:#000 }

  /* ===== SPLASH / LOADER ===== */
  .splash{
    position: fixed; inset: 0;
    display: grid; place-items: center;
    background: #fff;            /* fundo branco */
    z-index: 9999;
    overflow: hidden;
  }
  .splash img{
    width: var(--loader-size);
    height: auto;
    transform-origin: center;
    will-change: transform, opacity;
  }
  @keyframes heartbeat{
    0%{transform:scale(1)}
    25%{transform:scale(1.1)}
    45%{transform:scale(1)}
    65%{transform:scale(1.1)}
    100%{transform:scale(1)}
  }
  .heartbeat{ animation: heartbeat var(--beat-speed) ease-in-out infinite }
  @keyframes blast{ to{ transform: scale(18); opacity: 0 } }
  .blast{ animation: blast var(--blast-time) ease-out forwards }

  /* ===== STAGE ===== */
  .stage{
    position:relative;
    min-height:100vh;
    overflow:hidden;
    background:#000;
  }
  .banner{
    position:absolute; inset:0;
    width:100%; height:100%;
    object-fit:cover; object-position:center;
    opacity:0; transform: scale(1.02);
    transition: opacity var(--fade) ease, transform var(--fade) ease;
  }
  .banner.show{ opacity:1; transform: scale(1) }

  /* ===== Barra esquerda ===== */
  .rail{
    position:fixed; inset:0 auto 0 0;
    width:var(--rail-w);
    z-index: 999;
    pointer-events:none;
  }
  .rail-line{
    position:absolute; inset:0 auto 0 calc(var(--rail-w) - 2px);
    width:2px; background:rgba(255,255,255,.85);
  }
  .hamburger {
        position: absolute;
        padding: 14px 0!important;
        width: 100%;
        height: 58px;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        background: none;
        border: none;
        padding: 0;
        cursor: pointer;
        pointer-events: auto;
        border-bottom: 2px solid #fff;
    }
  .hamburger span{ height:5px; width:45px;margin:0 auto;background:#fff; display:block }
  .hamburger:focus-visible{ outline:2px solid #fff; outline-offset:3px }

  .logo-stack{
    position:absolute; left:0; bottom:0;
    width:var(--rail-w);
    background:#fff;
    display:flex; flex-direction:column; align-items:center; gap:20px;
    padding:0 0 70px;
    height:auto;
    pointer-events:auto;
  }
  .stack-item{ display:grid; place-items:center; width:70px; height:48px; transition: transform .25s ease }
  .stack-item img{ max-width:100%; max-height:100%; display:block; transition: filter .25s ease }
  .stack-item:hover,.stack-item:focus-visible{ transform: translateY(-2px) }
  .stack-item:hover img,.stack-item:focus-visible img{ filter: drop-shadow(0 2px 0 rgba(0,0,0,.06)) }

  /* ===== Header ===== */
  header.site{
    position:absolute; top:0; left:0; right:0; height:76px;
    display:grid; grid-template-columns: var(--rail-w) 1fr var(--rail-w);
    align-items:center; z-index:4; pointer-events:none;
  }
  .site .center{ pointer-events:auto; display:flex; justify-content:center; align-items:center }
  .site .center img{ height:46px; width:auto; }

  /* ===== Títulos ===== */
  .titles{
    position:absolute; left:calc(var(--rail-w) + var(--gutter));
    bottom: clamp(24px, 10vh, 84px);
    color:#fff; z-index:3;
  }
  .caption{ font-size: var(--subtitle-size); text-transform: uppercase; letter-spacing:.08em; margin-bottom:8px; opacity:.9 }
  .headline{ font-size: var(--title-size); font-weight:800;font-family: sans-serif; line-height:1.03; margin:0; position:relative; display:inline-block }
  .headline::after{
    content:""; position:absolute; left:0; bottom:-10px; height:3px; width:0; background:#fff; transition: width 450ms ease
  }
  .logo-stack a.stack-item {
        padding: 25px 0;
    }
  body.view-modelares .headline.modelares::after{ width: 140px }
  body.view-renovacoes .headline.renovacoes::after{ width: 160px }

  @media (max-width:768px){ 
      :root{ --rail-w:50px } 
      .site .center img{ height:40px } 
      .hamburger{height:50px;}
      .stack-item img {
            max-height: 35px!important;
        }
        .about--btn{font-size:11px;margin-bottom:30px;}
        .hamburger span{height: 4px;width: 30px;}
        .logo-stack{gap:10px}
        .titles{bottom: clamp(27px, 20vh, 100px);}
        h1 {
        -webkit-text-stroke: 1px #fff!important;
        }
        .about-inner{
            display:flex!important;
            flex-direction: column!important;
            row-gap: 40px;
            padding: 0!important;
        }
        .about-symbol{width:100%!important;}
        .about.visible .about-right{padding:0 20px;}
        .stack-item{width:50px;}
        .about-right p{font-size: 16px;}
  }
  /* acessibilidade: reduz movimento */
  @media (prefers-reduced-motion: reduce){
    .heartbeat,.blast{ animation:none !important }
    .splash{ display:none !important }
    .banner{ opacity:1 !important; transform:none !important }
  }
  .about--btn {
      writing-mode: vertical-rl;     /* texto na vertical */
      transform: rotate(180deg);     /* faz ler de baixo para cima */
      text-transform: uppercase;
      font-size: 13px;
      color: #000;
      text-decoration: none;
      display: flex;
      align-items: center;
      justify-content: center;
      height: auto;
      pointer-events: auto;
      border-top: 1px solid #ccc;
      border-bottom:3px solid #fff;
        padding-top: 30px;
    }
    .about--btn:hover,
    .about--btn:focus-visible {  
      background-color:#204a87;
      transition:background-color 2s, color 1s;
      color: #fff;                   /* assegura que não fica cinza */
      transform: rotate(180deg);     /* mantém a orientação, NÃO MOVES */
    }
    .about--btn.active,
    .about--btn.active:hover,
    .about--btn.active:focus,
    .about--btn.active:focus-visible {
      background-color:#204a87;
      color:#fff;
      transform: rotate(180deg); /* mantém a orientação */
    }

  h1 {
    -webkit-text-stroke: 4px #fff;
    color: transparent;
    font-size: 26vh;
 }
  .stack-item img {
        max-height: 50px;
    }
    
  /* ===== ABOUT SECTION ===== */
    .about {
      position: relative;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #204a87;
      color: #fff;
      overflow: hidden;
      padding: 12vh 50px;
    }
    
    .about-inner {
      display: grid;
      grid-template-columns: 1fr 1.5fr;
      align-items: center;
      max-width: 1200px;
      width: 100%;
      position: relative;
      padding:0 60px;
    }
    
    .about-left h2 {
      font-size: 3.8rem;             /* +30% */
      line-height: 1;
      color: #fff;
      margin: 0;
      opacity: 0;
      transform: translateX(-104px); /* +30% deslocação */
      transition: all 1s cubic-bezier(.4, 0, .2, 1);
    }
    
    .about-left h2 small {
      font-size: 1.1rem;
      font-weight: 600;
      letter-spacing: .08em;
    }
    
    .about-right {
      opacity: 0;
    }
    
    .about-right p {
      margin: 0 0 1em 0;
      color:#fff;
    }
    
    .about-symbol {
      position: absolute;
      right: -12%;
      width: 48%;                    /* +20–30% tamanho */
      max-width: 540px;
      opacity: 0;
      transform: translateX(156px);  /* +30% deslocação */
      transition: all 1.2s cubic-bezier(.4, 0, .2, 1);
      z-index: 0;
    }
    
    /* estado visível */
    .about.visible .about-left h2 {
      opacity: 1;
      transform: translateX(0);
      display: flex;
      flex-direction: column;
    }
    
    .about.visible .about-symbol {
      opacity: 0.1;
      transform: translateX(0);
    }
    
    .about.visible .about-right {
      opacity: 1;
      transform: translateY(0);
      font-size:22px;
    }
    #remodelacoes{background:#da6c27!important}
    #casasModulares{background:#10737d!important}
    /* ===== ANNOUNCEMENT BAR — marquee contínuo ===== */
    .announcement{
      width:100%;
      background:#fff;
      color:#0e2e55;
      border-top:1px solid rgba(0,0,0,.08);
      border-bottom:1px solid rgba(0,0,0,.08);
      max-height:100px;
      overflow:hidden;
    }
    
    .marquee{
      display:flex;
      align-items:center;
      gap:var(--gap, 64px);
      will-change: transform;
      /* arranque seguro */
      transform: translateX(0);
      animation: marquee linear infinite;
      animation-duration: var(--dur, 20s);
    }
    
    .announcement .msg{
      margin:0;
      padding:8px 0;
      font-size: clamp(42px, 4vw, 52px);
      font-weight: 900;
      text-transform: uppercase;
      white-space: nowrap;
      flex: 0 0 auto;
      color:#0e2e55;
    }
    
    /* pausa opcional ao hover (remover se não quiseres) */
    .announcement:hover .marquee{ animation-play-state: paused; }
    
    @keyframes marquee {
      to { transform: translateX(calc(-1 * var(--loopw, 50%))); }
    }
    
    /* acessibilidade: reduz movimento */
    @media (prefers-reduced-motion: reduce){
      .marquee{ animation: none; }
    }
    .about-left h2,
    .about-right,
    .about-symbol { will-change: transform, opacity; }
    /* ===== FOOTER ===== */
    .footer {
        background: #fff;
        color: #0e2e55;
        padding: 48px 6vw 18px;
        border-top: 1px solid rgba(0, 0, 0, .08);
        z-index: 999!important;
        position: absolute;
        width: 100%;
        min-height: 324px !important;
    }
    
    .footer-inner{
      max-width:1200px;
      margin:0 auto;
      display:grid;
      grid-template-columns: 1.2fr 1fr 1fr;
      gap:32px;
      align-items:start;
    }
    
    /* animação de entrada (usa .visible na section) */
    .footer .reveal{
      opacity:0;
      transform: translateY(24px);
      transition: opacity .7s ease, transform .7s ease;
    }
    .footer.visible .reveal{ opacity:1; transform:none }
    .footer.visible .reveal:nth-child(1){ transition-delay:.0s }
    .footer.visible .reveal:nth-child(2){ transition-delay:.12s }
    .footer.visible .reveal:nth-child(3){ transition-delay:.24s }
    
    .foot-logo{ height:44px; width:auto; margin-bottom:12px }
    .muted{ color:#4a5b76; margin:0 }
    
    h3{ margin:0 0 10px 0; font-size:16px; text-transform:uppercase;  }
    
    .foot-list{ list-style:none; margin:0; padding:0; }
    .foot-list a{
      color:#0e2e55; text-decoration:none; font-weight:700; text-transform:uppercase;display:inline-block; padding:6px 0;
    }
    .foot-list a:hover{ text-decoration:underline }
    
    .btn-primary{
      display:inline-block;
      margin:6px 0 12px;
      padding:12px 18px;
      background:#0e2e55; color:#fff; text-decoration:none;
      font-weight:800; text-transform:uppercase;
    }
    .btn-primary:hover{ filter:brightness(1.1) }
    
    .social{ display:flex; gap:12px }
    .social-btn{
      inline-size:44px; block-size:44px; display:grid; place-items:center;
      border:1px solid rgba(0,0,0,.1); border-radius:50%; text-decoration:none;
      color:#0e2e55; background:#fff;
      transition: transform .2s ease, background .2s ease;
    }
    .social-btn:hover{ transform: translateY(-2px); background:#f5f7fb }
    .ico{ width:22px; height:22px; fill:currentColor }
    
    .foot-bottom{
      margin-top:22px; padding-top:14px; border-top:1px solid rgba(0,0,0,.08);
      text-align:center; color:#4a5b76; font-size:13px;
    }
    
    /* Responsivo */
    @media (max-width: 860px){
      .footer-inner{ grid-template-columns: 1fr; gap:24px }
      .foot-logo{ height:38px }
    }

</style>
</head>
<body class="view-modelares">

<!-- ===== LOADER ===== -->
<div class="splash" id="splash" aria-label="A carregar…" role="status">
  <img src="imgs/symbol-blue.svg" alt="Símbolo Jolimag" id="splashLogo" class="heartbeat">
</div>

<main class="stage" id="stage">
  <!-- BANNERS -->
  <img id="banner-modelares" class="banner show"
       src="https://jolimag.pt/img/bg/modelar-house.jpg" alt="Casas Modulares">
  <img id="banner-renovacoes" class="banner"
       src="https://jolimag.ch/img/pexels-vecislavas-popa-1571458.jpg" alt="Renovações">

  <!-- HEADER -->
  <header class="site">
    <div></div>
    <div class="center">
      <img src="imgs/logo-grupo-jolimag.png" alt="JOLIMAG GRUPO">
    </div>
    <div></div>
  </header>

  <!-- TÍTULOS -->
  <div class="titles">
    <div class="caption" id="caption">Jolimag</div>
    <h1 class="headline modelares" id="title-modelares">CASAS MODULARES</h1>
    <h1 class="headline renovacoes" id="title-renovacoes" style="display:none">REMODELAÇÕES</h1>
  </div>

  <!-- BARRA ESQUERDA -->
  <aside class="rail" aria-label="Navegação de marcas">
    <span class="rail-line"></span>
    <button class="hamburger" aria-label="Abrir menu"><span></span><span></span><span></span></button>
    <div class="logo-stack">
      <a href="" class="about--btn stack-item">o grupo</a>
      <a class="stack-item" href="#" id="btn-modelares" aria-label="Casas Modulares">
        <img src="imgs/symbol-turquoise.svg" alt="Símbolo Casas Modulares">
      </a>
      <a class="stack-item" href="#" id="btn-renovacoes" aria-label="Renovações">
        <img src="imgs/symbol-orange.svg" alt="Símbolo Renovações">
      </a>
    </div>
  </aside>
</main>
<section id="about" class="about">
  <div class="about-inner">
    <div class="about-left">
      <h2><span>JOLIMAG</span><small>GRUPO</small></h2>
    </div>

    <div class="about-right">
      <p>
        Os primeiros anos de atividade da empresa permitiram a sua implantação no mercado,
        no que diz respeito ao relacionamento com os fornecedores e parceiros, bem como
        à seleção de uma equipa de efetivos permanentes.
      </p>
      <p>
        Atualmente, passando por uma fase de expansão da sua atividade, não só no que diz
        respeito ao aumento da produção anual, mas também por um aperfeiçoamento de técnicas
        e coordenação dos recursos humanos.
      </p>
    </div>

    <img class="about-symbol" src="imgs/symbol-white.svg" alt="">
  </div>
</section>
<section class="announcement" data-speed="50">
  <div class="marquee" id="marquee-1">
    <p class="msg">
      FABRICO PRÓPRIO • EQUIPAS ESPECIALIZADAS • PROJETOS CHAVE-NA-MÃO •
      RENOVAÇÕES E AMPLIAÇÕES • ASSISTÊNCIA TÉCNICA • QUALIDADE CERTIFICADA •
    </p>
    <!-- duplicado para loop contínuo -->
    <p class="msg" aria-hidden="true">
      FABRICO PRÓPRIO • EQUIPAS ESPECIALIZADAS • PROJETOS CHAVE-NA-MÃO •
      RENOVAÇÕES E AMPLIAÇÕES • ASSISTÊNCIA TÉCNICA • QUALIDADE CERTIFICADA •
    </p>
  </div>
</section>

<section id="casasModulares" class="casas-modelares about">
  <div class="about-inner">
    <div class="about-left">
      <h2><span>JOLIMAG</span><small>CASAS MODULARES</small></h2>
    </div>

    <div class="about-right">
      <p>
        Os primeiros anos de atividade da empresa permitiram a sua implantação no mercado,
        no que diz respeito ao relacionamento com os fornecedores e parceiros, bem como
        à seleção de uma equipa de efetivos permanentes.
      </p>
    </div>

    <img class="about-symbol" src="imgs/symbol-turquoise.svg" alt="">
  </div>
</section>
<section id="remodelacoes" class="about">
  <div class="about-inner">
    <div class="about-left">
      <h2><span>JOLIMAG</span><small>REMODELAÇÕES</small></h2>
    </div>

    <div class="about-right">
      <p>
        Os primeiros anos de atividade da empresa permitiram a sua implantação no mercado,
        no que diz respeito ao relacionamento com os fornecedores e parceiros, bem como
        à seleção de uma equipa de efetivos permanentes.
      </p>
    </div>

    <img class="about-symbol" src="imgs/symbol-orange.svg" alt="">
  </div>
</section>
<section id="footer" class="footer">
  <div class="footer-inner">
    <!-- coluna 1 -->
    <div class="foot-col reveal">
      <img src="imgs/logo-grupo-jolimag.png" alt="JOLIMAG GRUPO" class="foot-logo">
      <p class="muted">Soluções em Casas modulares e Remodelações — da conceção à instalação.</p>
    </div>

    <!-- coluna 2 -->
    <nav class="foot-col reveal">
      <h3>Serviços</h3>
      <ul class="foot-list">
        <li><a href="#casasModulares">Casas Modulares</a></li>
        <li><a href="#remodelacoes">Remodelações</a></li>
        <li><a href="#about">O Grupo</a></li>
      </ul>
    </nav>

    <!-- coluna 3 -->
    <div class="foot-col reveal">
      <h3>Fale connosco</h3>
      <a href="mailto:info@jolimag.pt" class="btn-primary">Pedir Orçamento</a>

      <div class="social">
        <a class="social-btn" href="#" target="_blank" rel="noopener" aria-label="Facebook">
          <!-- Facebook (monocromático) -->
          <svg viewBox="0 0 24 24" class="ico"><path d="M22 12.07C22 6.48 17.52 2 11.93 2 6.35 2 1.86 6.48 1.86 12.07c0 4.9 3.48 8.96 8.04 9.86v-6.98H7.9v-2.88h1.99v-2.2c0-1.97 1.17-3.05 2.96-3.05.86 0 1.76.15 1.76.15v1.94h-.99c-.98 0-1.29.61-1.29 1.24v1.92h2.2l-.35 2.88h-1.85v6.98c4.56-.9 8.04-4.96 8.04-9.86z"/></svg>
        </a>
        <a class="social-btn" href="#" target="_blank" rel="noopener" aria-label="Instagram">
          <!-- Instagram (monocromático) -->
          <svg viewBox="0 0 24 24" class="ico"><path d="M12 2.2c3.2 0 3.58.01 4.85.07 1.17.06 1.96.24 2.67.52a5 5 0 0 1 1.82 1.18 5 5 0 0 1 1.18 1.82c.28.71.46 1.5.52 2.67.06 1.27.07 1.64.07 4.85s-.01 3.58-.07 4.85c-.06 1.17-.24 1.96-.52 2.67a5 5 0 0 1-1.18 1.82 5 5 0 0 1-1.82 1.18c-.71.28-1.5.46-2.67.52-1.27.06-1.64.07-4.85.07s-3.58-.01-4.85-.07c-1.17-.06-1.96-.24-2.67-.52a5 5 0 0 1-1.82-1.18 5 5 0 0 1-1.18-1.82c-.28-.71-.46-1.5-.52-2.67C2.21 15.58 2.2 15.2 2.2 12s.01-3.58.07-4.85c.06-1.17.24-1.96.52-2.67A5 5 0 0 1 3.97 2.66 5 5 0 0 1 5.8 1.48c.71-.28 1.5-.46 2.67-.52C9.74 2.21 10.12 2.2 13.32 2.2H12Zm0 1.8c-3.16 0-3.53.01-4.77.07-.99.05-1.53.21-1.89.35-.48.19-.82.42-1.18.78-.36.36-.6.7-.78 1.18-.14.35-.3.9-.35 1.89-.06 1.24-.07 1.61-.07 4.77s.01 3.53.07 4.77c.05.99.21 1.53.35 1.89.19.48.42.82.78 1.18.36.36.7.6 1.18.78.35.14.9.3 1.89.35 1.24.06 1.61.07 4.77.07s3.53-.01 4.77-.07c.99-.05 1.53-.21 1.89-.35.48-.19.82-.42 1.18-.78.36-.36.6-.7.78-1.18.14-.35.3-.9.35-1.89.06-1.24.07-1.61.07-4.77s-.01-3.53-.07-4.77c-.05-.99-.21-1.53-.35-1.89a3.2 3.2 0 0 0-.78-1.18 3.2 3.2 0 0 0-1.18-.78c-.35-.14-.9-.3-1.89-.35-1.24-.06-1.61-.07-4.77-.07Zm0 3.7a6.3 6.3 0 1 1 0 12.6 6.3 6.3 0 0 1 0-12.6Zm0 2a4.3 4.3 0 1 0 0 8.6 4.3 4.3 0 0 0 0-8.6Zm5-2.5a1.1 1.1 0 1 1 0 2.2 1.1 1.1 0 0 1 0-2.2Z"/></svg>
        </a>
      </div>
    </div>
  </div>

  <div class="foot-bottom">
    <p>© <span id="year"></span> JOLIMAG GRUPO — <a href="" style="color:#000;text-decoration:none!important">evdeveloper.</a></p>
  </div>
</section>

<script>
  /* ---------- Loader ---------- */
  const splash      = document.getElementById('splash');
  const splashLogo  = document.getElementById('splashLogo');
  const BEAT_MS     = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--beat-time')) || 3000;
  const BLAST_MS    = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--blast-time')) || 600;
  const reduceMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

  function finishSplash(){
    splash.style.display = 'none';
    // revela o primeiro banner (já está .show) — nada a fazer
  }

  if (!reduceMotion){
    setTimeout(()=>{
      splashLogo.classList.remove('heartbeat');
      splashLogo.classList.add('blast');
      splashLogo.addEventListener('animationend', finishSplash, { once:true });
      setTimeout(finishSplash, BLAST_MS + 100); // fallback
    }, BEAT_MS);
  } else {
    finishSplash();
  }

  /* ---------- Banners & Títulos ---------- */
  const body       = document.body;
  const bModel     = document.getElementById('banner-modelares');
  const bReno      = document.getElementById('banner-renovacoes');
  const tModel     = document.getElementById('title-modelares');
  const tReno      = document.getElementById('title-renovacoes');
  const caption    = document.getElementById('caption');
  const btnModel   = document.getElementById('btn-modelares');
  const btnReno    = document.getElementById('btn-renovacoes');

  function showModelares(){
    body.classList.add('view-modelares');
    body.classList.remove('view-renovacoes');
    bModel.classList.add('show');  bReno.classList.remove('show');
    tModel.style.display='inline-block'; tReno.style.display='none';
    caption.textContent='Casas Modulares';
  }
  function showRenovacoes(){
    body.classList.remove('view-modelares');
    body.classList.add('view-renovacoes');
    bModel.classList.remove('show');  bReno.classList.add('show');
    tModel.style.display='none'; tReno.style.display='inline-block';
    caption.textContent='Renovações';
  }

  ['mouseenter','focus'].forEach(ev=>{
    btnModel.addEventListener(ev, showModelares);
    btnReno .addEventListener(ev, showRenovacoes);
  });
  ['mouseleave','blur'].forEach(ev=>{
    btnModel.addEventListener(ev, showModelares);
    btnReno .addEventListener(ev, showModelares);
  });

  btnModel.addEventListener('click', e=>{ e.preventDefault(); showModelares(); });
  btnReno .addEventListener('click', e=>{ e.preventDefault(); showRenovacoes(); });
  
// Scroll suave para o "O grupo"
document.querySelector('.about--btn').addEventListener('click', e => {
  e.preventDefault();
  document.getElementById('about').scrollIntoView({ behavior: 'smooth' });
});
document.querySelector('#btn-modelares').addEventListener('click', e => {
  e.preventDefault();
  document.getElementById('casasModulares').scrollIntoView({ behavior: 'smooth' });
});
document.querySelector('#btn-renovacoes').addEventListener('click', e => {
  e.preventDefault();
  document.getElementById('remodelacoes').scrollIntoView({ behavior: 'smooth' });
});

// === Reveal com histerese para TODAS as sections (menos .announcement) ===
revealSections('section:not(.announcement)', { enter: 0.45, exit: 0.20 });

function revealSections(selector, { enter = 0.4, exit = 0.2 } = {}) {
  const state = new WeakMap();

  const thresholds = Array.from({ length: 101 }, (_, i) => i / 100);

  const io = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      const el = entry.target;
      const ratio = entry.intersectionRatio;
      const on = state.get(el) === true;

      if (!on && ratio >= enter) {
        el.classList.add('visible');
        state.set(el, true);
      } else if (on && ratio <= exit) {
        el.classList.remove('visible');
        state.set(el, false);
      }
    });
  }, {
    threshold: thresholds,
    // margem negativa ligeira evita flicker perto do topo/rodapé do viewport
    rootMargin: '-8% 0px -8% 0px'
  });

  document.querySelectorAll(selector).forEach((el) => {
    state.set(el, false);
    io.observe(el);
  });
}



const aboutBtn = document.querySelector('.about--btn');

aboutBtn.addEventListener('click', (e) => {
  e.preventDefault(); // não navegar

  // aplica ativo já no 1.º clique
  aboutBtn.classList.add('active');

  // scroll suave para a secção
  document.getElementById('about').scrollIntoView({ behavior: 'smooth' });
});
const aboutSection = document.getElementById('about');

const spy = new IntersectionObserver(entries => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      aboutBtn.classList.add('active');
    } else {
      aboutBtn.classList.remove('active');
    }
  });
}, { threshold: 0.4 });

spy.observe(aboutSection);

// Marquee robusto (sem offscreen no mobile)
(function(){
  // px por segundo (podes ajustar via data-speed="90" no <section>)
  const DEFAULT_SPEED = 90;

  document.querySelectorAll('.announcement .marquee').forEach(track=>{
    const section = track.closest('.announcement');
    const speed = Number(section?.dataset.speed) || DEFAULT_SPEED;

    function setup(){
      // 1) garantir pelo menos 2 cópias
      let items = Array.from(track.querySelectorAll('.msg'));
      if(items.length < 2){
        const clone = items[0].cloneNode(true);
        clone.setAttribute('aria-hidden','true');
        track.appendChild(clone);
        items = Array.from(track.querySelectorAll('.msg'));
      }

      // 2) medir larguras
      const containerW = section.clientWidth;
      const firstW = items[0].scrollWidth;
      const gap = parseInt(getComputedStyle(track).getPropertyValue('--gap')) || 64;

      // 3) clonar até o conteúdo cobrir pelo menos 2x o container (loop perfeito)
      //    evita “buracos” e o bug no mobile
      let totalW = items.reduce((acc, el) => acc + el.scrollWidth, 0) + (items.length - 1) * gap;
      while(totalW < containerW * 2){
        const c = items[0].cloneNode(true);
        c.setAttribute('aria-hidden','true');
        track.appendChild(c);
        items.push(c);
        totalW += firstW + gap;
      }

      // 4) definir variáveis CSS para a animação
      //    loopw = largura de um ciclo (1ª mensagem + gap)
      track.style.setProperty('--loopw', `${firstW + gap}px`);
      // duração = distância / velocidade
      const duration = (firstW + gap) / speed; // s
      track.style.setProperty('--dur', `${duration}s`);
    }

    // preparar agora e ao redimensionar
    setup();
    window.addEventListener('resize', ()=>{
      // limpar clones extra antes de recalcular
      const originals = Array.from(track.querySelectorAll('.msg')).slice(0,2);
      track.innerHTML = '';
      originals.forEach(n=>track.appendChild(n));
      setup();
    }, { passive:true });
  });
})();
// ano automático no rodapé
document.getElementById('year').textContent = new Date().getFullYear();

</script>
</body>
</html>
